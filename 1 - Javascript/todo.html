<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToDo List</title>
    <link rel="stylesheet" type="text/css" href="styles.css">

    <!-- include our framework javascript -->
    <script src="outputTypes.js"></script>
    <script src="app.js"></script>
</head>
<body id="app">
        <!-- I've included some extra 'junk' divs just to show the recursion is working -->
        <div><div><div>
            
            <div class="container">
                <p>
                    This application is more about the framework idea than the overall purpose of the application; the app is built to show how the framework works.
                </p>
                <div id="inputArea">
                    <label for="myInput">Type Item Here</label>
                    <input id="myInput" type="text" data-bind-type="text" placeholder="Type your todo text here.">
                </div>
                    <!-- I made this button out of a div to show that the framework can add click events to any type of element. -->
                <div id="addTodoButton" data-bind-type="button" data-bind-method="addTodo">Click here to add ToDo the list</div>


                
                <section id="outputArea">
                    <p>This section shows the output div element is update in realtime when typing. It is not important for the ToDo list app, but is showing the javascript framework I started.</p>
                    <div id="outputDiv" data-bind-type="output" data-bind-source="myInput"></div>
                </section>
                <div id="toDoList">
                    <ul data-bind-type="boundList" data-bind-source="toDoItems"></ul>
                </div>



            </div>

    <!-- closing junk divs -->
    </div></div></div>

    <script>


        // create a ToDo item class to represent the items we want to add to the list
        // This could return any type of HTML item that make sense inside of a <li> 
        // The framework would be made more robust in the future and allow us to work with more than <li> items. but for now
        // the framework is returning the items from bound lists wrapped in an <li>
        class ToDoItem {
            constructor(text){
                this.text = text;
                return this.createItem()
            }

            createItem(){
                let e = document.createElement('span');
                e.setAttribute('data-bind-method', 'removeTodo')
                e.setAttribute('data-bind-type', 'button')
                registerElements(e)
                e.textContent = this.text
                return e
            }


        }
        

        // create methods for our app and register them with the 'framework'
        // the methods need to accept the event parameter which contains the event that was fired. 
        addTodo = (event) => {
            // get our bound array from the framework
            todoList = getBoundArray('toDoItems');
            // get our input value (using the framework just makes this a smidge easier)
            todoText = getInputValue('myInput');

            if (todoText != ""){
            // create a new todo item
            let newItem = new ToDoItem(todoText);
            todoList.push(newItem)
            }
            // add the item to the array
        }

        // we register the method which makes it available to the framework. 
        // You then bind the elements in the dom to use it by using data-bind attributes
        registerMethod('addTodo', addTodo);

        removeTodo = (event) => {
            // get our bound array from the framework
            todoList = getBoundArray('toDoItems');
            // remove the item from the array which since the list is bound to the data of the array, the list is updated
            // automatically
            todoList.removeItem(todoList.indexOf(event.target))
        }
        registerMethod('removeTodo', removeTodo)


        //starting the app causes the framework to register the html elements with data-bind- attributes 
        startApp('app');
    </script>
</body>
</html>